spring:
  config:
    import: optional:file:.env[.properties]
  application:
    name: rental-management-system

  datasource:
    url: ${DB_URL}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false  # never true in production â€” move to dev profile if needed
    properties:
      hibernate:
        format_sql: false
        dialect: org.hibernate.dialect.MySQLDialect

  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
    clean-disabled: true
    out-of-order: true
    validate-on-migrate: false

  mail:
    host: smtp.gmail.com
    port: 465
    username: ${EMAIL_USERNAME}
    password: ${EMAIL_PASSWORD}
    protocol: smtp
    default-encoding: UTF-8
    properties:
      mail:
        smtp:
          auth: true
          ssl:
            enable: true
          connectiontimeout: 10000
          timeout: 10000
          writetimeout: 10000
          socketFactory:
            class: javax.net.ssl.SSLSocketFactory
      test-connection: false
      test-connection-on-startup: false

  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 100MB

  mvc:
    static-path-pattern: /static/**

  web:
    resources:
      static-locations: classpath:/static/,file:./uploads/

app:
  frontend-url: ${FRONTEND_URL}
  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS}
    allowed-methods: GET,POST,PUT,DELETE,PATCH,OPTIONS,HEAD
    allowed-headers: "*"
    expose-headers: Authorization,Content-Disposition
    allow-credentials: true
    max-age: 3600

  upload-dir: ./uploads

  verification:
    verify-url: ${app.frontend-url}/verify-email

  testing:
    auto-verify-email: false  # overridden to true in application-dev.yml only

jwt:
  secret: ${JWT_SECRET}
  expiration-ms: 86400000

mpesa:
  consumer-key: ${MPESA_CONSUMER_KEY}
  consumer-secret: ${MPESA_CONSUMER_SECRET}
  passkey: ${MPESA_PASSKEY}
  shortcode: "174379"
  stk-push-url: "https://sandbox.safaricom.co.ke/mpesa/stkpush/v1/processrequest"
  auth-url: "https://sandbox.safaricom.co.ke/oauth/v1/generate"
  callback-url: ${MPESA_CALLBACK_URL}
  environment: "sandbox"

stripe:
  api:
    key: ${STRIPE_SECRET_KEY}
    public-key: ${STRIPE_PUBLISHABLE_KEY}

twilio:
  account-sid: ${TWILIO_ACCOUNT_SID}
  auth-token: ${TWILIO_AUTH_TOKEN}
  phone-number: ${TWILIO_PHONE_NUMBER}
  messaging-service-sid: ${TWILIO_MESSAGING_SERVICE_SID}

server:
  port: 8080
  compression:
    enabled: true
    mime-types: text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
    min-response-size: 1024

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      enabled: true
      show-details: always
    metrics:
      enabled: true
  health:
    mail:
      enabled: false

logging:
  level:
    root: INFO
    com.peterscode: INFO       # use DEBUG only in dev profile
    org.springframework.security: WARN  # DEBUG leaks tokens/headers
    org.springframework.mail: WARN
    org.springframework.web: WARN
    org.flywaydb: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n"